<PASTE THE FULL FINAL VERSION OF THE CODE FROM THE CANVAS HERE>